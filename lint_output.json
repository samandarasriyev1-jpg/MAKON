[{"filePath":"C:\\Users\\acer\\Documents\\MAKON\\makon\\src\\app\\(dashboard)\\dashboard\\community\\page.tsx","messages":[{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":169,"column":45,"nodeType":"JSXOpeningElement","endLine":169,"endColumn":135}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useEffect, useState, useCallback } from \"react\";\r\nimport { createClient } from \"@/lib/supabase/client\";\r\nimport { useAuth } from \"@/components/providers/auth-provider\";\r\nimport { Loader2, MessageSquare, ThumbsUp, Send, User } from \"lucide-react\";\r\nimport { EventsCalendar } from \"@/components/community/EventsCalendar\";\r\n\r\ninterface Post {\r\n    id: string;\r\n    title: string | null;\r\n    content: string;\r\n    likes_count: number;\r\n    comments_count: number;\r\n    created_at: string;\r\n    profiles: {\r\n        full_name: string | null;\r\n        avatar_url: string | null;\r\n    } | null;\r\n    user_has_liked?: boolean;\r\n}\r\n\r\nexport default function CommunityPage() {\r\n    const { user, isLoading: authLoading } = useAuth();\r\n    const supabase = createClient();\r\n    const [posts, setPosts] = useState<Post[]>([]);\r\n    const [loading, setLoading] = useState(true);\r\n    const [newPostContent, setNewPostContent] = useState(\"\");\r\n    const [isSubmitting, setIsSubmitting] = useState(false);\r\n\r\n    const fetchPosts = useCallback(async () => {\r\n        setLoading(true);\r\n        try {\r\n            const { data, error } = await supabase\r\n                .from(\"community_posts\")\r\n                .select(`\r\n                    id, title, content, likes_count, comments_count, created_at,\r\n                    profiles(full_name, avatar_url)\r\n                `)\r\n                .order(\"created_at\", { ascending: false });\r\n\r\n            if (data && user) {\r\n                // Check which posts the user has liked\r\n                const postIds = data.map(p => p.id);\r\n                const { data: likesData } = await supabase\r\n                    .from(\"post_likes\")\r\n                    .select(\"post_id\")\r\n                    .eq(\"user_id\", user.id)\r\n                    .in(\"post_id\", postIds);\r\n\r\n                const likedSet = new Set(likesData?.map(l => l.post_id) || []);\r\n                const postsWithLikes = data.map((post: any) => ({\r\n                    ...post,\r\n                    user_has_liked: likedSet.has(post.id)\r\n                }));\r\n                setPosts(postsWithLikes);\r\n            } else if (data) {\r\n                setPosts(data as any);\r\n            }\r\n        } catch (error) {\r\n            console.error(error);\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    }, [supabase, user]);\r\n\r\n    useEffect(() => {\r\n        if (authLoading) return;\r\n        fetchPosts();\r\n    }, [authLoading, fetchPosts]);\r\n\r\n    const handleCreatePost = async (e: React.FormEvent) => {\r\n        e.preventDefault();\r\n        if (!newPostContent.trim() || !user) return;\r\n\r\n        setIsSubmitting(true);\r\n        try {\r\n            const { error } = await supabase\r\n                .from(\"community_posts\")\r\n                .insert({\r\n                    author_id: user.id,\r\n                    content: newPostContent,\r\n                });\r\n\r\n            if (!error) {\r\n                setNewPostContent(\"\");\r\n                fetchPosts(); // Refresh list\r\n            }\r\n        } catch (err) {\r\n            console.error(err);\r\n        } finally {\r\n            setIsSubmitting(false);\r\n        }\r\n    };\r\n\r\n    const handleLike = async (postId: string, currentlyLiked: boolean, currentCount: number) => {\r\n        if (!user) return;\r\n\r\n        // Optimistic UI update\r\n        setPosts(posts.map(post =>\r\n            post.id === postId\r\n                ? { ...post, user_has_liked: !currentlyLiked, likes_count: currentlyLiked ? currentCount - 1 : currentCount + 1 }\r\n                : post\r\n        ));\r\n\r\n        try {\r\n            if (currentlyLiked) {\r\n                await supabase.from(\"post_likes\").delete().match({ post_id: postId, user_id: user.id });\r\n                await supabase.rpc('decrement_post_likes', { p_post_id: postId }); // Assuming RPC exists or managed another way\r\n                // Fallback direct update since we don't know if RPC exists:\r\n                await supabase.from(\"community_posts\").update({ likes_count: currentCount - 1 }).eq(\"id\", postId);\r\n            } else {\r\n                await supabase.from(\"post_likes\").insert({ post_id: postId, user_id: user.id });\r\n                await supabase.from(\"community_posts\").update({ likes_count: currentCount + 1 }).eq(\"id\", postId);\r\n            }\r\n        } catch (err) {\r\n            console.error(err);\r\n            // Revert on error\r\n            fetchPosts();\r\n        }\r\n    };\r\n\r\n    if (authLoading || loading) {\r\n        return (\r\n            <div className=\"flex h-[50vh] items-center justify-center\">\r\n                <Loader2 className=\"h-8 w-8 animate-spin text-primary\" />\r\n            </div>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <div className=\"max-w-6xl mx-auto space-y-8\">\r\n            <div>\r\n                <h1 className=\"text-3xl font-bold text-white glow-text\">Hamjamiyat</h1>\r\n                <p className=\"text-muted-foreground mt-2\">Boshqa o&apos;quvchilar bilan tajriba almashing va savol bering.</p>\r\n            </div>\r\n\r\n            <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-8\">\r\n                <div className=\"lg:col-span-2 space-y-8\">\r\n                    {/* Create Post */}\r\n                    <div className=\"glass-card p-6 rounded-3xl\">\r\n                        <form onSubmit={handleCreatePost}>\r\n                            <textarea\r\n                                value={newPostContent}\r\n                                onChange={(e) => setNewPostContent(e.target.value)}\r\n                                placeholder=\"Yangi mavzu qidiring yoki o'rtoqlashing...\"\r\n                                className=\"w-full bg-white/5 border border-white/10 rounded-2xl p-4 text-white focus:outline-none focus:border-primary min-h-[120px] resize-none\"\r\n                            />\r\n                            <div className=\"flex justify-end mt-4\">\r\n                                <button\r\n                                    type=\"submit\"\r\n                                    disabled={isSubmitting || !newPostContent.trim()}\r\n                                    className=\"bg-primary text-[#0A192F] px-6 py-2 rounded-xl font-bold hover:bg-primary/90 transition-all flex items-center gap-2 disabled:opacity-50\"\r\n                                >\r\n                                    {isSubmitting ? <Loader2 className=\"h-5 w-5 animate-spin\" /> : <Send className=\"h-5 w-5\" />}\r\n                                    Ulashish\r\n                                </button>\r\n                            </div>\r\n                        </form>\r\n                    </div>\r\n\r\n                    {/* Posts List */}\r\n                    <div className=\"space-y-6\">\r\n                        {posts.map((post) => (\r\n                            <div key={post.id} className=\"glass-card p-6 rounded-3xl hover:bg-white/5 transition-colors group cursor-pointer\">\r\n                                <div className=\"flex items-start gap-4\">\r\n                                    <div className=\"h-12 w-12 rounded-full bg-gradient-to-tr from-primary to-purple-500 overflow-hidden shrink-0 flex items-center justify-center\">\r\n                                        {post.profiles?.avatar_url ? (\r\n                                            <img src={post.profiles.avatar_url} alt=\"avatar\" className=\"w-full h-full object-cover\" />\r\n                                        ) : (\r\n                                            <User className=\"h-6 w-6 text-white\" />\r\n                                        )}\r\n                                    </div>\r\n                                    <div className=\"flex-1\">\r\n                                        <div className=\"flex items-center justify-between mb-2\">\r\n                                            <h4 className=\"font-bold text-white\">{post.profiles?.full_name || \"O'quvchi\"}</h4>\r\n                                            <span className=\"text-xs text-muted-foreground\">\r\n                                                {new Date(post.created_at).toLocaleDateString(\"uz-UZ\", {\r\n                                                    month: \"short\", day: \"numeric\", hour: \"2-digit\", minute: \"2-digit\"\r\n                                                })}\r\n                                            </span>\r\n                                        </div>\r\n                                        <p className=\"text-gray-300 leading-relaxed whitespace-pre-wrap\">{post.content}</p>\r\n\r\n                                        <div className=\"flex items-center gap-6 mt-4\">\r\n                                            <button\r\n                                                onClick={() => handleLike(post.id, !!post.user_has_liked, post.likes_count)}\r\n                                                className={`flex items-center gap-2 transition-colors text-sm font-medium ${post.user_has_liked ? 'text-primary' : 'text-muted-foreground hover:text-primary'}`}\r\n                                            >\r\n                                                <ThumbsUp className={`h-4 w-4 ${post.user_has_liked ? 'fill-primary' : ''}`} />\r\n                                                {post.likes_count} Likes\r\n                                            </button>\r\n                                            <button className=\"flex items-center gap-2 text-muted-foreground hover:text-blue-400 transition-colors text-sm font-medium\">\r\n                                                <MessageSquare className=\"h-4 w-4\" />\r\n                                                {post.comments_count} Kammentlar\r\n                                            </button>\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n                        ))}\r\n\r\n                        {posts.length === 0 && (\r\n                            <div className=\"text-center py-12 text-muted-foreground glass-card rounded-3xl\">\r\n                                Hozircha hech qanday post yo&apos;q. Birinchi bo&apos;lib yozing!\r\n                            </div>\r\n                        )}\r\n                    </div>\r\n                </div>\r\n\r\n                {/* Sidebar */}\r\n                <div className=\"space-y-8\">\r\n                    <EventsCalendar />\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\acer\\Documents\\MAKON\\makon\\src\\app\\(dashboard)\\dashboard\\page.tsx","messages":[{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":214,"column":45,"nodeType":"JSXOpeningElement","endLine":214,"endColumn":133}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { Wallet, Users, BookOpen, TrendingUp, Loader2, Flame, Trophy } from \"lucide-react\";\r\nimport Link from \"next/link\";\r\nimport { useEffect, useState } from \"react\";\r\nimport { createClient } from \"@/lib/supabase/client\";\r\nimport { useAuth } from \"@/components/providers/auth-provider\";\r\nimport { useProgress } from \"@/components/providers/progress-provider\";\r\nimport { PlayCircle } from \"lucide-react\";\r\nimport { RewardTrophy } from \"@/components/ui/3d/RewardTrophy\";\r\nimport { BadgeViewer } from \"@/components/ui/3d/BadgeViewer\";\r\nimport { AiRecommendations } from \"@/components/dashboard/AiRecommendations\";\r\n\r\nexport default function DashboardPage() {\r\n    const { user, isLoading: authLoading } = useAuth();\r\n    const { progress, getLastAccessedLesson } = useProgress();\r\n    const supabase = createClient();\r\n    const [stats, setStats] = useState({\r\n        courses: 0,\r\n        progress: 0,\r\n        xp: 0,\r\n        wallet: 0,\r\n        streak: 0,\r\n        league: \"Yog'och\",\r\n    });\r\n    const [loading, setLoading] = useState(true);\r\n    const [lastAccessData, setLastAccessData] = useState<{ courseTitle: string, lessonTitle: string, progressSec: number } | null>(null);\r\n    const [leaderboard, setLeaderboard] = useState<any[]>([]);\r\n\r\n    const lastAccess = getLastAccessedLesson();\r\n\r\n    useEffect(() => {\r\n        if (authLoading) return;\r\n        if (!user) {\r\n            setLoading(false);\r\n            return;\r\n        }\r\n\r\n        async function fetchData() {\r\n            setLoading(true);\r\n            try {\r\n                // 1. Get Wallet Balance\r\n                const { data: userData } = await supabase\r\n                    .from(\"users\")\r\n                    .select(\"wallet_balance\")\r\n                    .eq(\"id\", user!.id)\r\n                    .maybeSingle();\r\n\r\n                // 2. Get Gamification XP and League\r\n                const { data: gameData } = await supabase\r\n                    .from(\"gamification_profiles\")\r\n                    .select(\"total_xp, leagues(name)\")\r\n                    .eq(\"user_id\", user!.id)\r\n                    .maybeSingle();\r\n\r\n                // 3. Get Streak\r\n                const { data: streakData } = await supabase\r\n                    .from(\"user_streaks\")\r\n                    .select(\"current_streak\")\r\n                    .eq(\"user_id\", user!.id)\r\n                    .maybeSingle();\r\n\r\n                setStats({\r\n                    courses: 0,\r\n                    progress: 0,\r\n                    xp: gameData?.total_xp || 0,\r\n                    wallet: userData?.wallet_balance || 0,\r\n                    streak: streakData?.current_streak || 0,\r\n                    league: gameData?.leagues ? (gameData.leagues as any)?.name : \"Yog'och\",\r\n                });\r\n            } catch (error) {\r\n                console.error(\"Dashboard loading error:\", error);\r\n            } finally {\r\n                setLoading(false);\r\n            }\r\n        }\r\n\r\n        async function fetchLastAccessDetails() {\r\n            if (!lastAccess) return;\r\n            try {\r\n                const { data } = await supabase\r\n                    .from('lessons')\r\n                    .select('title, course:courses(title)')\r\n                    .eq('id', lastAccess.lesson_id)\r\n                    .single();\r\n\r\n                if (data) {\r\n                    setLastAccessData({\r\n                        lessonTitle: data.title,\r\n                        courseTitle: (data.course as any)?.title || 'Kurs',\r\n                        progressSec: lastAccess.progress_seconds\r\n                    });\r\n                }\r\n            } catch (err) {\r\n                console.error(err);\r\n            }\r\n        }\r\n\r\n        async function fetchLeaderboard() {\r\n            try {\r\n                const { data } = await supabase\r\n                    .from('gamification_profiles')\r\n                    .select('total_xp, profiles(full_name, avatar_url)')\r\n                    .order('total_xp', { ascending: false })\r\n                    .limit(5);\r\n\r\n                if (data) setLeaderboard(data);\r\n            } catch (err) {\r\n                console.error(\"Leaderboard fetch error\", err);\r\n            }\r\n        }\r\n\r\n        fetchData();\r\n        fetchLastAccessDetails();\r\n        fetchLeaderboard();\r\n    }, [user, authLoading, supabase, lastAccess]);\r\n\r\n    if (authLoading || loading) {\r\n        return (\r\n            <div className=\"flex h-[50vh] items-center justify-center\">\r\n                <Loader2 className=\"h-8 w-8 animate-spin text-primary\" />\r\n            </div>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <div className=\"space-y-8\">\r\n            {/* Header */}\r\n            <div>\r\n                <h1 className=\"text-3xl font-bold tracking-tight text-white glow-text\">\r\n                    Xush kelibsiz, {user?.phone || \"Student\"}!\r\n                </h1>\r\n                <p className=\"text-muted-foreground mt-2\">\r\n                    Bugungi o&apos;qish jarayoningiz va statistikangiz.\r\n                </p>\r\n            </div>\r\n\r\n            {/* Stats Grid */}\r\n            <div className=\"grid gap-6 md:grid-cols-2 lg:grid-cols-5\">\r\n                {[\r\n                    { label: \"Streak\", value: `${stats.streak} kun`, icon: Flame, color: \"text-orange-500\", glow: \"shadow-[0_0_15px_rgba(249,115,22,0.5)]\" },\r\n                    { label: \"O'zlashtirilgan\", value: progress.filter((p: any) => p.completed).length.toString(), icon: BookOpen, color: \"text-blue-400\" },\r\n                    { label: \"Liga\", value: stats.league, icon: Trophy, color: \"text-yellow-400\" },\r\n                    { label: \"Hamjamiyat XP\", value: stats.xp.toLocaleString(), icon: Users, color: \"text-purple-400\" },\r\n                    { label: \"Hamyon\", value: `${stats.wallet.toLocaleString()} UZS`, icon: Wallet, color: \"text-primary\" },\r\n                ].map((stat, i) => {\r\n                    const isWallet = stat.label === \"Hamyon\";\r\n                    const Content = (\r\n                        <div key={i} className={`glass-card p-6 flex flex-col justify-between hover:bg-white/10 transition-colors ${stat.glow || \"\"} ${isWallet ? \"cursor-pointer ring-1 ring-primary/50\" : \"\"}`}>\r\n                            <div className=\"flex items-center justify-between\">\r\n                                <span className=\"text-sm font-medium text-muted-foreground\">{stat.label}</span>\r\n                                <stat.icon className={`h-5 w-5 ${stat.color} ${stat.label === 'Streak' && stats.streak > 0 ? 'animate-pulse' : ''}`} />\r\n                            </div>\r\n                            <div className=\"mt-4 text-2xl font-bold text-white\">{stat.value}</div>\r\n                        </div>\r\n                    );\r\n\r\n                    return isWallet ? (\r\n                        <Link href=\"/dashboard/wallet\" key={i}>\r\n                            {Content}\r\n                        </Link>\r\n                    ) : (\r\n                        Content\r\n                    );\r\n                })}\r\n            </div>\r\n\r\n            {/* Recent Activity & AI / Content Placeholder */}\r\n            <div className=\"grid gap-6 lg:grid-cols-3\">\r\n                <div className=\"flex flex-col gap-6 lg:col-span-2\">\r\n                    {/* Activity Box */}\r\n                    <div className=\"glass-card p-6 flex flex-col items-start min-h-[220px]\">\r\n                        <h3 className=\"text-lg font-semibold text-white mb-4\">Davom etish</h3>\r\n\r\n                        {lastAccess && lastAccessData ? (\r\n                            <div className=\"w-full flex-1 rounded-xl bg-white/5 border border-white/10 p-6 flex flex-col justify-between hover:bg-white/10 transition-colors cursor-pointer relative overflow-hidden group\">\r\n                                <Link href={`/dashboard/courses/${lastAccess.course_id}/lessons/${lastAccess.lesson_id}`} className=\"absolute inset-0 z-10\" />\r\n                                <div>\r\n                                    <div className=\"text-xs uppercase tracking-wider text-muted-foreground font-semibold mb-2\">{lastAccessData.courseTitle}</div>\r\n                                    <h4 className=\"text-xl font-bold text-white max-w-[80%]\">{lastAccessData.lessonTitle}</h4>\r\n                                </div>\r\n\r\n                                <div className=\"flex items-center justify-between mt-6\">\r\n                                    <div className=\"text-sm text-green-400 flex items-center gap-2\">\r\n                                        <PlayCircle className=\"h-5 w-5\" />\r\n                                        Davom etish\r\n                                    </div>\r\n                                    <div className=\"text-xs text-muted-foreground\">\r\n                                        {Math.floor(lastAccessData.progressSec / 60)} daqiqa o&apos;qildi\r\n                                    </div>\r\n                                </div>\r\n                                <div className=\"absolute right-[-20px] bottom-[-20px] opacity-10 group-hover:scale-110 transition-transform duration-500\">\r\n                                    <PlayCircle className=\"h-40 w-40\" />\r\n                                </div>\r\n                            </div>\r\n                        ) : (\r\n                            <div className=\"w-full h-full min-h-[140px] rounded-xl bg-white/5 flex items-center justify-center text-muted-foreground border border-dashed border-white/10\">\r\n                                Hozircha faol kurslar yo&apos;q\r\n                            </div>\r\n                        )}\r\n                    </div>\r\n\r\n                    {/* AI Recommendations Box */}\r\n                    <AiRecommendations />\r\n                </div>\r\n                <div className=\"glass-card p-6\">\r\n                    <h3 className=\"text-lg font-semibold text-white mb-4\">Leaderboard - {stats.league} Ligasi</h3>\r\n                    <div className=\"space-y-4\">\r\n                        {leaderboard.length > 0 ? leaderboard.map((lb, idx) => (\r\n                            <div key={idx} className={`flex items-center justify-between p-2 rounded-lg bg-white/5 border border-transparent ${lb.profiles?.full_name === user?.user_metadata?.full_name ? 'border-primary/50 bg-primary/10' : ''}`}>\r\n                                <div className=\"flex items-center gap-3\">\r\n                                    <div className=\"h-8 w-8 rounded-full bg-gradient-to-tr from-primary to-purple-500 flex items-center justify-center text-xs font-bold overflow-hidden\">\r\n                                        {lb.profiles?.avatar_url ? (\r\n                                            <img src={lb.profiles.avatar_url} alt=\"avatar\" className=\"w-full h-full object-cover\" />\r\n                                        ) : (\r\n                                            lb.profiles?.full_name?.charAt(0) || \"U\"\r\n                                        )}\r\n                                    </div>\r\n                                    <span className=\"text-sm font-medium\">{lb.profiles?.full_name || \"Foydalanuvchi\"}</span>\r\n                                </div>\r\n                                <span className=\"text-xs font-bold text-primary\">{lb.total_xp.toLocaleString()} XP</span>\r\n                            </div>\r\n                        )) : (\r\n                            <div className=\"text-sm text-muted-foreground text-center py-4\">Leaderboard yuklanmoqda...</div>\r\n                        )}\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n            {/* 3D Premium Integrations */}\r\n            <div className=\"grid gap-6 lg:grid-cols-2 mt-8\">\r\n                {/* 3D Reward Trophy */}\r\n                <div className=\"glass-card p-6 rounded-3xl relative overflow-hidden group border border-yellow-500/20\">\r\n                    <div className=\"absolute top-0 right-0 w-64 h-64 bg-yellow-500/10 rounded-full blur-3xl\" />\r\n                    <h3 className=\"text-xl font-bold text-white mb-2\">Sizning Kubogingiz</h3>\r\n                    <p className=\"text-sm text-muted-foreground mb-4\">Ligadagi doimiy faolligingiz va yutuqlaringiz uchun maxsus mukofot. (Sichqoncha bilan aylantiring)</p>\r\n                    <div className=\"w-full h-[300px] rounded-2xl bg-black/20 border border-white/5 overflow-hidden mt-4\">\r\n                        <RewardTrophy />\r\n                    </div>\r\n                </div>\r\n\r\n                {/* 3D Badge Viewer */}\r\n                <div className=\"glass-card p-6 rounded-3xl relative overflow-hidden group border border-blue-500/20\">\r\n                    <div className=\"absolute top-0 right-0 w-64 h-64 bg-blue-500/10 rounded-full blur-3xl\" />\r\n                    <h3 className=\"text-xl font-bold text-white mb-2\">3D Nishonlar (Badges)</h3>\r\n                    <p className=\"text-sm text-muted-foreground mb-4\">Noyob kolleksiyangizni 3D formatda tomosha qiling.</p>\r\n                    <div className=\"w-full h-[300px] rounded-2xl bg-black/20 border border-white/5 overflow-hidden mt-4 flex items-center justify-center\">\r\n                        <BadgeViewer />\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\acer\\Documents\\MAKON\\makon\\src\\app\\(dashboard)\\dashboard\\wallet\\page.tsx","messages":[{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`'` can be escaped with `&apos;`, `&lsquo;`, `&#39;`, `&rsquo;`.","line":309,"column":68,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&apos;"},"fix":{"range":[15226,15252],"text":"Do&apos;kon (O'yin Elementlari)"},"desc":"Replace with `&apos;`."},{"messageId":"replaceWithAlt","data":{"alt":"&lsquo;"},"fix":{"range":[15226,15252],"text":"Do&lsquo;kon (O'yin Elementlari)"},"desc":"Replace with `&lsquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#39;"},"fix":{"range":[15226,15252],"text":"Do&#39;kon (O'yin Elementlari)"},"desc":"Replace with `&#39;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rsquo;"},"fix":{"range":[15226,15252],"text":"Do&rsquo;kon (O'yin Elementlari)"},"desc":"Replace with `&rsquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`'` can be escaped with `&apos;`, `&lsquo;`, `&#39;`, `&rsquo;`.","line":309,"column":75,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&apos;"},"fix":{"range":[15226,15252],"text":"Do'kon (O&apos;yin Elementlari)"},"desc":"Replace with `&apos;`."},{"messageId":"replaceWithAlt","data":{"alt":"&lsquo;"},"fix":{"range":[15226,15252],"text":"Do'kon (O&lsquo;yin Elementlari)"},"desc":"Replace with `&lsquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#39;"},"fix":{"range":[15226,15252],"text":"Do'kon (O&#39;yin Elementlari)"},"desc":"Replace with `&#39;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rsquo;"},"fix":{"range":[15226,15252],"text":"Do'kon (O&rsquo;yin Elementlari)"},"desc":"Replace with `&rsquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`'` can be escaped with `&apos;`, `&lsquo;`, `&#39;`, `&rsquo;`.","line":319,"column":124,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&apos;"},"fix":{"range":[15990,16114],"text":"Agar bir kun dars qila olmasangiz, Streak (Olov) o&apos;chmasligini ta'minlaydi. O'tkazib yuborilgan kuningizni muzlatib qo'yadi."},"desc":"Replace with `&apos;`."},{"messageId":"replaceWithAlt","data":{"alt":"&lsquo;"},"fix":{"range":[15990,16114],"text":"Agar bir kun dars qila olmasangiz, Streak (Olov) o&lsquo;chmasligini ta'minlaydi. O'tkazib yuborilgan kuningizni muzlatib qo'yadi."},"desc":"Replace with `&lsquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#39;"},"fix":{"range":[15990,16114],"text":"Agar bir kun dars qila olmasangiz, Streak (Olov) o&#39;chmasligini ta'minlaydi. O'tkazib yuborilgan kuningizni muzlatib qo'yadi."},"desc":"Replace with `&#39;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rsquo;"},"fix":{"range":[15990,16114],"text":"Agar bir kun dars qila olmasangiz, Streak (Olov) o&rsquo;chmasligini ta'minlaydi. O'tkazib yuborilgan kuningizni muzlatib qo'yadi."},"desc":"Replace with `&rsquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`'` can be escaped with `&apos;`, `&lsquo;`, `&#39;`, `&rsquo;`.","line":319,"column":139,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&apos;"},"fix":{"range":[15990,16114],"text":"Agar bir kun dars qila olmasangiz, Streak (Olov) o'chmasligini ta&apos;minlaydi. O'tkazib yuborilgan kuningizni muzlatib qo'yadi."},"desc":"Replace with `&apos;`."},{"messageId":"replaceWithAlt","data":{"alt":"&lsquo;"},"fix":{"range":[15990,16114],"text":"Agar bir kun dars qila olmasangiz, Streak (Olov) o'chmasligini ta&lsquo;minlaydi. O'tkazib yuborilgan kuningizni muzlatib qo'yadi."},"desc":"Replace with `&lsquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#39;"},"fix":{"range":[15990,16114],"text":"Agar bir kun dars qila olmasangiz, Streak (Olov) o'chmasligini ta&#39;minlaydi. O'tkazib yuborilgan kuningizni muzlatib qo'yadi."},"desc":"Replace with `&#39;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rsquo;"},"fix":{"range":[15990,16114],"text":"Agar bir kun dars qila olmasangiz, Streak (Olov) o'chmasligini ta&rsquo;minlaydi. O'tkazib yuborilgan kuningizni muzlatib qo'yadi."},"desc":"Replace with `&rsquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`'` can be escaped with `&apos;`, `&lsquo;`, `&#39;`, `&rsquo;`.","line":319,"column":151,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&apos;"},"fix":{"range":[15990,16114],"text":"Agar bir kun dars qila olmasangiz, Streak (Olov) o'chmasligini ta'minlaydi. O&apos;tkazib yuborilgan kuningizni muzlatib qo'yadi."},"desc":"Replace with `&apos;`."},{"messageId":"replaceWithAlt","data":{"alt":"&lsquo;"},"fix":{"range":[15990,16114],"text":"Agar bir kun dars qila olmasangiz, Streak (Olov) o'chmasligini ta'minlaydi. O&lsquo;tkazib yuborilgan kuningizni muzlatib qo'yadi."},"desc":"Replace with `&lsquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#39;"},"fix":{"range":[15990,16114],"text":"Agar bir kun dars qila olmasangiz, Streak (Olov) o'chmasligini ta'minlaydi. O&#39;tkazib yuborilgan kuningizni muzlatib qo'yadi."},"desc":"Replace with `&#39;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rsquo;"},"fix":{"range":[15990,16114],"text":"Agar bir kun dars qila olmasangiz, Streak (Olov) o'chmasligini ta'minlaydi. O&rsquo;tkazib yuborilgan kuningizni muzlatib qo'yadi."},"desc":"Replace with `&rsquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`'` can be escaped with `&apos;`, `&lsquo;`, `&#39;`, `&rsquo;`.","line":319,"column":192,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&apos;"},"fix":{"range":[15990,16114],"text":"Agar bir kun dars qila olmasangiz, Streak (Olov) o'chmasligini ta'minlaydi. O'tkazib yuborilgan kuningizni muzlatib qo&apos;yadi."},"desc":"Replace with `&apos;`."},{"messageId":"replaceWithAlt","data":{"alt":"&lsquo;"},"fix":{"range":[15990,16114],"text":"Agar bir kun dars qila olmasangiz, Streak (Olov) o'chmasligini ta'minlaydi. O'tkazib yuborilgan kuningizni muzlatib qo&lsquo;yadi."},"desc":"Replace with `&lsquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#39;"},"fix":{"range":[15990,16114],"text":"Agar bir kun dars qila olmasangiz, Streak (Olov) o'chmasligini ta'minlaydi. O'tkazib yuborilgan kuningizni muzlatib qo&#39;yadi."},"desc":"Replace with `&#39;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rsquo;"},"fix":{"range":[15990,16114],"text":"Agar bir kun dars qila olmasangiz, Streak (Olov) o'chmasligini ta'minlaydi. O'tkazib yuborilgan kuningizni muzlatib qo&rsquo;yadi."},"desc":"Replace with `&rsquo;`."}]}],"suppressedMessages":[],"errorCount":6,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useEffect, useState } from \"react\";\r\nimport { createClient } from \"@/lib/supabase/client\";\r\nimport { useAuth } from \"@/components/providers/auth-provider\";\r\nimport {\r\n    Wallet,\r\n    ArrowUpRight,\r\n    ArrowDownLeft,\r\n    History,\r\n    CreditCard,\r\n    Download,\r\n    Loader2,\r\n    X,\r\n    CheckCircle2,\r\n    Snowflake,\r\n    ShoppingCart\r\n} from \"lucide-react\";\r\n\r\ninterface Transaction {\r\n    id: string;\r\n    amount: number;\r\n    type: 'credit' | 'debit';\r\n    description: string;\r\n    created_at: string;\r\n    status: 'completed' | 'pending' | 'failed';\r\n}\r\n\r\nexport default function WalletPage() {\r\n    const { user, isLoading: authLoading } = useAuth();\r\n    const supabase = createClient();\r\n    const [balance, setBalance] = useState(0);\r\n    const [transactions, setTransactions] = useState<Transaction[]>([]);\r\n    const [loading, setLoading] = useState(true);\r\n\r\n    // Modals State\r\n    const [isWithdrawOpen, setIsWithdrawOpen] = useState(false);\r\n    const [isAddCardOpen, setIsAddCardOpen] = useState(false);\r\n\r\n    // Form State\r\n    const [withdrawAmount, setWithdrawAmount] = useState(\"\");\r\n    const [cardNumber, setCardNumber] = useState(\"\");\r\n    const [cardExpiry, setCardExpiry] = useState(\"\");\r\n\r\n    // Status State\r\n    const [statusMessage, setStatusMessage] = useState<{ type: 'success' | 'error', text: string } | null>(null);\r\n    const [isBuying, setIsBuying] = useState(false);\r\n    const STREAK_FREEZE_PRICE = 10000;\r\n\r\n    useEffect(() => {\r\n        if (authLoading) return;\r\n        if (!user) {\r\n            setLoading(false);\r\n            return;\r\n        }\r\n\r\n        async function fetchData() {\r\n            setLoading(true);\r\n            try {\r\n                const { data: userData } = await supabase\r\n                    .from(\"users\")\r\n                    .select(\"wallet_balance\")\r\n                    .eq(\"id\", user!.id)\r\n                    .maybeSingle();\r\n\r\n                setBalance(userData?.wallet_balance || 0);\r\n\r\n                setTransactions([\r\n                    {\r\n                        id: \"1\",\r\n                        amount: 150000,\r\n                        type: \"credit\",\r\n                        description: \"Frontend kursi sotuvi (Affiliate)\",\r\n                        created_at: new Date().toISOString(),\r\n                        status: \"completed\"\r\n                    },\r\n                    {\r\n                        id: \"2\",\r\n                        amount: 50000,\r\n                        type: \"debit\",\r\n                        description: \"Premium obuna to'lovi\",\r\n                        created_at: new Date(Date.now() - 86400000).toISOString(),\r\n                        status: \"completed\"\r\n                    }\r\n                ]);\r\n            } catch (error) {\r\n                console.error(\"Wallet loading error:\", error);\r\n            } finally {\r\n                setLoading(false);\r\n            }\r\n        }\r\n        fetchData();\r\n    }, [user, authLoading, supabase]);\r\n\r\n    const handleWithdraw = (e: React.FormEvent) => {\r\n        e.preventDefault();\r\n        // Mock API Call\r\n        setTimeout(() => {\r\n            setIsWithdrawOpen(false);\r\n            setStatusMessage({ type: 'success', text: \"So'rov muvaffaqiyatli yuborildi!\" });\r\n            setWithdrawAmount(\"\");\r\n            setTimeout(() => setStatusMessage(null), 3000);\r\n        }, 1000);\r\n    };\r\n\r\n    const handleAddCard = (e: React.FormEvent) => {\r\n        e.preventDefault();\r\n        // Mock API Call\r\n        setTimeout(() => {\r\n            setIsAddCardOpen(false);\r\n            setStatusMessage({ type: 'success', text: \"Karta muvaffaqiyatli qo'shildi!\" });\r\n            setCardNumber(\"\");\r\n            setCardExpiry(\"\");\r\n            setTimeout(() => setStatusMessage(null), 3000);\r\n        }, 1000);\r\n    };\r\n\r\n    const handleBuyFreeze = async () => {\r\n        if (balance < STREAK_FREEZE_PRICE) {\r\n            setStatusMessage({ type: 'error', text: \"Mablag' yetarli emas!\" });\r\n            setTimeout(() => setStatusMessage(null), 3000);\r\n            return;\r\n        }\r\n\r\n        setIsBuying(true);\r\n        try {\r\n            const res = await fetch(\"/api/shop/buy\", {\r\n                method: \"POST\",\r\n                headers: { \"Content-Type\": \"application/json\" },\r\n                body: JSON.stringify({ item_id: \"streak_freeze\", price: STREAK_FREEZE_PRICE }),\r\n            });\r\n\r\n            const data = await res.json();\r\n            if (res.ok && data.success) {\r\n                setBalance(data.newBalance);\r\n                setStatusMessage({ type: 'success', text: \"Muzlashkun sotib olindi! Endi 1 kun kirmasangiz ham olovingiz o'chmaydi.\" });\r\n            } else {\r\n                setStatusMessage({ type: 'error', text: data.error || \"Xatolik yuz berdi\" });\r\n            }\r\n        } catch (err) {\r\n            setStatusMessage({ type: 'error', text: \"Xatolik yuz berdi\" });\r\n        } finally {\r\n            setTimeout(() => setStatusMessage(null), 4000);\r\n            setIsBuying(false);\r\n        }\r\n    };\r\n\r\n    if (authLoading || loading) {\r\n        return (\r\n            <div className=\"flex h-[50vh] items-center justify-center\">\r\n                <Loader2 className=\"h-8 w-8 animate-spin text-primary\" />\r\n            </div>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <div className=\"space-y-8 relative\">\r\n            {/* Status Toast */}\r\n            {statusMessage && (\r\n                <div className=\"fixed top-4 right-4 z-50 animate-in fade-in slide-in-from-top-4\">\r\n                    <div className={`glass-card p-4 rounded-xl flex items-center gap-3 border ${statusMessage.type === 'success' ? 'border-green-500/30 bg-green-500/10 text-green-400' : 'border-red-500/30 bg-red-500/10 text-red-400'}`}>\r\n                        {statusMessage.type === 'success' ? <CheckCircle2 className=\"h-5 w-5\" /> : <X className=\"h-5 w-5\" />}\r\n                        <span className=\"font-bold\">{statusMessage.text}</span>\r\n                    </div>\r\n                </div>\r\n            )}\r\n\r\n            {/* Withdraw Modal */}\r\n            {isWithdrawOpen && (\r\n                <div className=\"fixed inset-0 z-50 flex items-center justify-center bg-black/60 backdrop-blur-sm p-4\">\r\n                    <div className=\"glass-card w-full max-w-md p-6 rounded-3xl animate-in fade-in zoom-in duration-200\">\r\n                        <div className=\"flex items-center justify-between mb-6\">\r\n                            <h3 className=\"text-xl font-bold text-white\">Pulni Yechish</h3>\r\n                            <button onClick={() => setIsWithdrawOpen(false)} className=\"text-muted-foreground hover:text-white\">\r\n                                <X className=\"h-6 w-6\" />\r\n                            </button>\r\n                        </div>\r\n                        <form onSubmit={handleWithdraw} className=\"space-y-4\">\r\n                            <div>\r\n                                <label className=\"text-sm text-muted-foreground mb-2 block\">Summa (UZS)</label>\r\n                                <input\r\n                                    type=\"number\"\r\n                                    value={withdrawAmount}\r\n                                    onChange={(e) => setWithdrawAmount(e.target.value)}\r\n                                    placeholder=\"Masalan: 100,000\"\r\n                                    className=\"w-full bg-white/5 border border-white/10 rounded-xl px-4 py-3 text-white focus:border-primary focus:outline-none font-mono text-lg\"\r\n                                    required\r\n                                />\r\n                                <p className=\"text-xs text-muted-foreground mt-2\">Mavjud: {balance.toLocaleString()} UZS</p>\r\n                            </div>\r\n                            <button type=\"submit\" className=\"w-full bg-primary text-[#0A192F] font-bold py-3 rounded-xl hover:bg-primary/90 transition-all\">\r\n                                Tasdiqlash\r\n                            </button>\r\n                        </form>\r\n                    </div>\r\n                </div>\r\n            )}\r\n\r\n            {/* Add Card Modal */}\r\n            {isAddCardOpen && (\r\n                <div className=\"fixed inset-0 z-50 flex items-center justify-center bg-black/60 backdrop-blur-sm p-4\">\r\n                    <div className=\"glass-card w-full max-w-md p-6 rounded-3xl animate-in fade-in zoom-in duration-200\">\r\n                        <div className=\"flex items-center justify-between mb-6\">\r\n                            <h3 className=\"text-xl font-bold text-white\">Karta Qo&apos;shish</h3>\r\n                            <button onClick={() => setIsAddCardOpen(false)} className=\"text-muted-foreground hover:text-white\">\r\n                                <X className=\"h-6 w-6\" />\r\n                            </button>\r\n                        </div>\r\n                        <form onSubmit={handleAddCard} className=\"space-y-4\">\r\n                            <div>\r\n                                <label className=\"text-sm text-muted-foreground mb-2 block\">Karta Raqami</label>\r\n                                <input\r\n                                    type=\"text\"\r\n                                    value={cardNumber}\r\n                                    onChange={(e) => setCardNumber(e.target.value)}\r\n                                    placeholder=\"8600 0000 0000 0000\"\r\n                                    className=\"w-full bg-white/5 border border-white/10 rounded-xl px-4 py-3 text-white focus:border-primary focus:outline-none font-mono text-lg\"\r\n                                    required\r\n                                />\r\n                            </div>\r\n                            <div>\r\n                                <label className=\"text-sm text-muted-foreground mb-2 block\">Amal Qilish Muddat</label>\r\n                                <input\r\n                                    type=\"text\"\r\n                                    value={cardExpiry}\r\n                                    onChange={(e) => setCardExpiry(e.target.value)}\r\n                                    placeholder=\"MM/YY\"\r\n                                    className=\"w-full bg-white/5 border border-white/10 rounded-xl px-4 py-3 text-white focus:border-primary focus:outline-none font-mono text-lg\"\r\n                                    required\r\n                                />\r\n                            </div>\r\n                            <button type=\"submit\" className=\"w-full bg-primary text-[#0A192F] font-bold py-3 rounded-xl hover:bg-primary/90 transition-all\">\r\n                                Saqlash\r\n                            </button>\r\n                        </form>\r\n                    </div>\r\n                </div>\r\n            )}\r\n\r\n            <div className=\"flex items-center justify-between\">\r\n                <div>\r\n                    <h1 className=\"text-3xl font-bold text-white glow-text\">Mening Hamyonim</h1>\r\n                    <p className=\"text-muted-foreground mt-2\">\r\n                        Mablag&apos;larni boshqarish va to&apos;lovlar tarixi.\r\n                    </p>\r\n                </div>\r\n                <button\r\n                    onClick={() => setIsWithdrawOpen(true)}\r\n                    className=\"bg-primary text-[#0A192F] px-6 py-3 rounded-xl font-bold hover:bg-primary/90 transition-all shadow-lg shadow-primary/20 flex items-center gap-2\"\r\n                >\r\n                    <Download className=\"h-5 w-5\" />\r\n                    Pulni Yechish\r\n                </button>\r\n            </div>\r\n\r\n            {/* Balance Card */}\r\n            <div className=\"grid gap-6 md:grid-cols-2\">\r\n                <div className=\"glass-card p-8 rounded-3xl relative overflow-hidden group\">\r\n                    <div className=\"absolute top-0 right-0 p-8 opacity-10 group-hover:opacity-20 transition-opacity\">\r\n                        <Wallet className=\"h-48 w-48 text-primary\" />\r\n                    </div>\r\n\r\n                    <div className=\"relative z-10\">\r\n                        <span className=\"text-muted-foreground font-medium\">Joriy Balans</span>\r\n                        <div className=\"text-5xl font-mono font-bold text-white mt-4 tracking-tighter\">\r\n                            {balance.toLocaleString()} <span className=\"text-2xl text-primary\">UZS</span>\r\n                        </div>\r\n\r\n                        <div className=\"mt-8 flex gap-4\">\r\n                            <div className=\"flex items-center gap-2 text-green-400 bg-green-400/10 px-3 py-1.5 rounded-lg border border-green-400/20\">\r\n                                <ArrowUpRight className=\"h-4 w-4\" />\r\n                                <span className=\"text-sm font-bold\">+150,000 bu oy</span>\r\n                            </div>\r\n                            <div className=\"flex items-center gap-2 text-red-400 bg-red-400/10 px-3 py-1.5 rounded-lg border border-red-400/20\">\r\n                                <ArrowDownLeft className=\"h-4 w-4\" />\r\n                                <span className=\"text-sm font-bold\">-50,000 bu oy</span>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n\r\n                {/* Quick Actions */}\r\n                <div className=\"glass-card p-8 rounded-3xl flex flex-col justify-center gap-4\">\r\n                    <h3 className=\"font-bold text-white mb-2\">Tezkor Amallar</h3>\r\n                    <div className=\"grid grid-cols-2 gap-4\">\r\n                        <button\r\n                            onClick={() => setIsAddCardOpen(true)}\r\n                            className=\"p-4 rounded-2xl bg-white/5 hover:bg-white/10 border border-white/10 hover:border-primary/50 transition-all flex flex-col items-center gap-3 text-center group\"\r\n                        >\r\n                            <div className=\"h-10 w-10 rounded-full bg-blue-500/20 flex items-center justify-center group-hover:scale-110 transition-transform\">\r\n                                <CreditCard className=\"h-5 w-5 text-blue-400\" />\r\n                            </div>\r\n                            <span className=\"text-sm font-medium text-white\">Karta Qo&apos;shish</span>\r\n                        </button>\r\n                        <button className=\"p-4 rounded-2xl bg-white/5 hover:bg-white/10 border border-white/10 hover:border-primary/50 transition-all flex flex-col items-center gap-3 text-center group\">\r\n                            <div className=\"h-10 w-10 rounded-full bg-primary/20 flex items-center justify-center group-hover:scale-110 transition-transform\">\r\n                                <History className=\"h-5 w-5 text-primary\" />\r\n                            </div>\r\n                            <span className=\"text-sm font-medium text-white\">To&apos;liq Tarix</span>\r\n                        </button>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n            {/* Gamification Shop section */}\r\n            <div className=\"glass-card p-8 rounded-3xl mt-8 relative overflow-hidden group\">\r\n                <div className=\"flex items-center gap-3 mb-6\">\r\n                    <ShoppingCart className=\"h-6 w-6 text-purple-400\" />\r\n                    <h3 className=\"font-bold text-xl text-white\">Do'kon (O'yin Elementlari)</h3>\r\n                </div>\r\n\r\n                <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6\">\r\n                    <div className=\"bg-white/5 border border-white/10 rounded-2xl p-6 flex flex-col justify-between hover:bg-white/10 hover:border-purple-400/50 transition-all\">\r\n                        <div>\r\n                            <div className=\"h-12 w-12 rounded-xl bg-blue-500/20 flex items-center justify-center mb-4\">\r\n                                <Snowflake className=\"h-6 w-6 text-blue-400\" />\r\n                            </div>\r\n                            <h4 className=\"text-lg font-bold text-white mb-2\">Streak Freeze (Muzlashkun)</h4>\r\n                            <p className=\"text-sm text-muted-foreground\">Agar bir kun dars qila olmasangiz, Streak (Olov) o'chmasligini ta'minlaydi. O'tkazib yuborilgan kuningizni muzlatib qo'yadi.</p>\r\n                        </div>\r\n                        <div className=\"mt-6 flex items-center justify-between\">\r\n                            <span className=\"font-mono font-bold text-white\">{STREAK_FREEZE_PRICE.toLocaleString()} UZS</span>\r\n                            <button\r\n                                onClick={handleBuyFreeze}\r\n                                disabled={isBuying || balance < STREAK_FREEZE_PRICE}\r\n                                className=\"px-4 py-2 rounded-lg bg-blue-500 hover:bg-blue-600 text-white font-bold text-sm transition-colors disabled:opacity-50 flex items-center justify-center min-w-[100px]\"\r\n                            >\r\n                                {isBuying ? <Loader2 className=\"h-4 w-4 animate-spin\" /> : \"Sotib olish\"}\r\n                            </button>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n            {/* Transaction History */}\r\n            <div className=\"glass-card rounded-3xl overflow-hidden\">\r\n                <div className=\"p-6 border-b border-white/10 flex items-center justify-between\">\r\n                    <h3 className=\"font-bold text-white flex items-center gap-2\">\r\n                        <History className=\"h-5 w-5 text-primary\" />\r\n                        So&apos;nggi O&apos;tkazmalar\r\n                    </h3>\r\n                </div>\r\n                <div className=\"divide-y divide-white/5\">\r\n                    {transactions.map((tx) => (\r\n                        <div key={tx.id} className=\"p-6 flex items-center justify-between hover:bg-white/5 transition-colors\">\r\n                            <div className=\"flex items-center gap-4\">\r\n                                <div className={`h-12 w-12 rounded-full flex items-center justify-center ${tx.type === 'credit' ? 'bg-green-500/10 text-green-500' : 'bg-red-500/10 text-red-500'\r\n                                    }`}>\r\n                                    {tx.type === 'credit' ? <ArrowUpRight className=\"h-6 w-6\" /> : <ArrowDownLeft className=\"h-6 w-6\" />}\r\n                                </div>\r\n                                <div>\r\n                                    <p className=\"font-bold text-white\">{tx.description}</p>\r\n                                    <p className=\"text-xs text-muted-foreground mt-1\">\r\n                                        {new Date(tx.created_at).toLocaleDateString('uz-UZ', {\r\n                                            year: 'numeric',\r\n                                            month: 'long',\r\n                                            day: 'numeric',\r\n                                            hour: '2-digit',\r\n                                            minute: '2-digit'\r\n                                        })}\r\n                                    </p>\r\n                                </div>\r\n                            </div>\r\n                            <div className=\"text-right\">\r\n                                <p className={`font-mono font-bold ${tx.type === 'credit' ? 'text-green-400' : 'text-white'\r\n                                    }`}>\r\n                                    {tx.type === 'credit' ? '+' : '-'}{tx.amount.toLocaleString()} UZS\r\n                                </p>\r\n                                <span className={`text-xs uppercase font-bold px-2 py-0.5 rounded ${tx.status === 'completed' ? 'bg-green-500/20 text-green-400' : 'bg-yellow-500/20 text-yellow-400'\r\n                                    }`}>\r\n                                    {tx.status}\r\n                                </span>\r\n                            </div>\r\n                        </div>\r\n                    ))}\r\n                    {transactions.length === 0 && (\r\n                        <div className=\"p-12 text-center text-muted-foreground\">\r\n                            Hozircha o&apos;tkazmalar yo&apos;q.\r\n                        </div>\r\n                    )}\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]}]